This was my first solution.

I wrote it in Java.
I wrote a test.

What are the advantages?

* It is fast.
* Reasonably easy to change.
* Static type safety with the enum.

What are the disadvantages?

* The relationships are duplicated, once for up the hierarchy and once for down the hierarchy.
** This makes maintainence harder and the introduction of bugs more likely in the future.
* The resulting data structures are mutable and could be changed by any callee.
* Lack of an interface could make testing more challenging if parallel tests are run and the relationships change for specific tests.

What am I neutral on?

* How readable is it?
* Could the hierarchy relationships easily be changed at runtime?
